<!--pages/index/index.wxml-->
<view class="container">
  <!-- å¤´éƒ¨ -->
  <view class="header">
    <view class="header-left">
      <image class="app-icon" src="/images/app-icon.png" mode="aspectFit"></image>
      <view class="title-group">
        <text class="title">ç®€èµ„ Assetly</text>
        <text class="subtitle">ä¸ªäººèµ„äº§ç®¡ç†</text>
      </view>
    </view>
    <view class="header-right">
        <view class="add-btn" bindtap="goToAdd">
          <text class="add-icon">+</text>
        </view>
      </view>
  </view>

  <!-- æ€»èµ„äº§å¡ç‰‡ -->
  <view class="total-card">
    <view class="total-left">
      <text class="total-label">æ€»èµ„äº§</text>
      <text class="total-amount">{{formattedTotalAmount}}</text>
    </view>
    <view class="total-right">
      <text class="asset-count-text">{{assetCount}}</text>
      <text class="asset-count-label">é¡¹èµ„äº§</text>
    </view>
  </view>

  <!-- èµ„äº§åˆ—è¡¨ -->
  <view class="asset-section" wx:if="{{assetCount > 0}}">
    <view class="section-header">
      <text class="section-title">èµ„äº§åˆ—è¡¨</text>
      <view class="sort-options">
        <text class="sort-btn {{sortBy === 'time' ? 'active' : ''}}" bindtap="sortByTime">æ—¶é—´</text>
        <text class="sort-btn {{sortBy === 'amount' ? 'active' : ''}}" bindtap="sortByAmount">é‡‘é¢</text>
      </view>
    </view>
    <view class="category-groups">
      <view class="category-group" wx:for="{{groupedAssets}}" wx:key="category">
        <view class="category-header">
          <view class="category-dot" style="background-color: {{item.color}}"></view>
          <text class="category-name">{{item.category}}</text>
          <text class="category-total">{{item.formattedTotal}}</text>
        </view>
        <view class="asset-list">
          <view class="asset-item" wx:for="{{item.assets}}" wx:key="id" wx:for-item="asset" bindtap="editAsset" data-asset="{{asset}}">
            <view class="asset-left">
              <view class="asset-info">
                <text class="asset-name">{{asset.name}}</text>
                <view class="asset-meta">
                  <text class="asset-date">{{formatDate(asset.createTime || asset.createdAt)}}</text>
                  <text class="asset-holding" wx:if="{{asset.holdingTime}}">æŒæœ‰{{asset.holdingTime}}</text>
                </view>
              </view>
              <text class="asset-remark" wx:if="{{asset.remark}}">{{asset.remark}}</text>
            </view>
            <view class="asset-right">
            <text class="asset-amount number">{{asset.formattedDisplayValue}}</text>
            <text class="asset-original number" wx:if="{{asset.currentValue !== undefined && asset.currentValue !== asset.amount}}">
              åŸä»·: {{asset.formattedAmount}}
            </text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{assetCount === 0}}">
    <view class="empty-icon">ğŸ“Š</view>
    <text class="empty-title">è¿˜æ²¡æœ‰èµ„äº§è®°å½•</text>
    <text class="empty-desc">ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æ·»åŠ æ‚¨çš„ç¬¬ä¸€é¡¹èµ„äº§</text>
    <button class="empty-btn" bindtap="goToAdd">ç«‹å³æ·»åŠ </button>
  </view>
</view>